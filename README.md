# üß™ Dot-Workbench - Integra√ß√£o Jest com TypeScript + Vite

<p align="center">
  <a href="https://github.com/eryckassis/Dot-Workbench/actions/workflows/ci.yml">
    <img src="https://github.com/eryckassis/Dot-Workbench/actions/workflows/ci.yml/badge.svg" alt="CI Status">
  </a>
  <a href="https://codecov.io/gh/eryckassis/Dot-Workbench">
    <img src="https://codecov.io/gh/eryckassis/Dot-Workbench/branch/master/graph/badge.svg" alt="Coverage">
  </a>
  <a href="https://github.com/eryckassis/Dot-Workbench/blob/master/LICENSE">
    <img src="https://img.shields.io/github/license/eryckassis/Dot-Workbench" alt="License">
  </a>
  <a href="https://github.com/eryckassis/Dot-Workbench/issues">
    <img src="https://img.shields.io/github/issues/eryckassis/Dot-Workbench" alt="Issues">
  </a>
  <a href="https://github.com/eryckassis/Dot-Workbench/pulls">
    <img src="https://img.shields.io/github/issues-pr/eryckassis/Dot-Workbench" alt="Pull Requests">
  </a>
</p>

<p align="center">
  <a href="https://github.com/eryckassis/Dot-Workbench/stargazers">
    <img src="https://img.shields.io/github/stars/eryckassis/Dot-Workbench?style=social" alt="Stars">
  </a>
  <a href="https://github.com/eryckassis/Dot-Workbench/network/members">
    <img src="https://img.shields.io/github/forks/eryckassis/Dot-Workbench?style=social" alt="Forks">
  </a>
</p>

## üìä Status do Projeto

![Node Version](https://img.shields.io/badge/node-%3E%3D18-brightgreen)
![TypeScript](https://img.shields.io/badge/TypeScript-5.9-blue)
![Jest](https://img.shields.io/badge/Jest-30.2-red)
![Playwright](https://img.shields.io/badge/Playwright-1.56-45ba4b)
![Vite](https://img.shields.io/badge/Vite-7.1-646CFF)
![ESLint](https://img.shields.io/badge/ESLint-9.38-4B32C3)

### Quality Gates

![Code Quality](https://img.shields.io/badge/code%20quality-A+-brightgreen)
![Maintainability](https://img.shields.io/badge/maintainability-A-brightgreen)
![Test Coverage](https://codecov.io/gh/eryckassis/Dot-Workbench/branch/master/graph/badge.svg)
![E2E Tests](https://img.shields.io/badge/E2E%20tests-85%2B-brightgreen)
![Accessibility](https://img.shields.io/badge/WCAG-2.1%20AA-blue)

## üöÄ Pipeline Status

| Check        | Status                                                                                    |
| ------------ | ----------------------------------------------------------------------------------------- |
| CI/CD        | ![CI](https://github.com/eryckassis/Dot-Workbench/actions/workflows/ci.yml/badge.svg)     |
| Unit Tests   | ![Tests](https://img.shields.io/badge/unit%20tests-passing-brightgreen)                   |
| E2E Tests    | ![E2E](https://img.shields.io/badge/E2E%20tests-passing-brightgreen)                      |
| Coverage     | ![Coverage](https://codecov.io/gh/eryckassis/Dot-Workbench/branch/master/graph/badge.svg) |
| Dependencies | ![Dependencies](https://img.shields.io/badge/dependencies-up%20to%20date-brightgreen)     |
| Code Style   | ![Code Style](https://img.shields.io/badge/code%20style-prettier-ff69b4)                  |
| Commits      | ![Commits](https://img.shields.io/badge/commits-conventional-brightgreen)                 |

## üìä M√©tricas de Qualidade

Code Coverage: 85%+ üéØ
Code Quality: A+ ‚≠ê
Maintainability: High üöÄ
Technical Debt: Low ‚úÖ

## üõ†Ô∏è Stack Tecnol√≥gica

### Build & Development

- ‚ö° **Vite** - Build tool e dev server
- üìò **TypeScript** - Type safety e DX melhorado

### Testing

- üß™ **Jest** - Unit testing framework
- üé≠ **Playwright** - E2E testing multi-browser
- ‚ôø **axe-core** - Accessibility testing (WCAG 2.1)

### Code Quality

- üé® **ESLint** - Code linting
- ‚ú® **Prettier** - Code formatting
- üîÑ **Husky** - Git hooks
- üìù **Commitlint** - Commit standards

### CI/CD

- ü§ñ **GitHub Actions** - Continuous Integration
- üìä **CodeCov** - Coverage reporting
- ü§ñ **Dependabot** - Dependency updates

## üìà Status dos Testes

![Test Results](https://img.shields.io/badge/tests-passing-brightgreen)
![Unit Tests](https://img.shields.io/badge/unit%20tests-‚úì-brightgreen)
![Integration Tests](https://img.shields.io/badge/integration%20tests-‚úì-brightgreen)

## üîí Seguran√ßa

![Security](https://img.shields.io/badge/security-A-brightgreen)
![Vulnerabilities](https://img.shields.io/badge/vulnerabilities-0-brightgreen)

Ambiente modular para constru√ß√£o de interfaces em grid de pontos (spotlight / dot-grid), com foco em acessibilidade, performance, escalabilidade e manuten√ß√£o. C√≥digo leve, leg√≠vel e consistente em TypeScript, com sem√¢ntica HTML otimizada para SEO.

**PLUS**: Integra√ß√£o completa de testes automatizados Jest com TypeScript/Vite, incluindo todas as configura√ß√µes necess√°rias e solu√ß√µes para problemas comuns.

## üéØ Objetivos

- Estrutura sustent√°vel: f√°cil evolu√ß√£o sem d√≠vidas t√©cnicas.
- Clean Code + SOLID + separa√ß√£o de camadas.
- Baixo acoplamento, alta coes√£o.
- Reutiliza√ß√£o de componentes (design system incremental).
- SEO t√©cnico aplicado (sem√¢ntica, performance, meta-informa√ß√£o).
- **Testes automatizados profissionais com Jest**

## üöÄ Principais Recursos

- Renderiza√ß√£o de grid interativo.
- Sistema de plugins/extens√µes.
- Tipagem forte (TypeScript estrito).
- Build otimizado para distribui√ß√£o.
- Estrutura pronta para SSR ou static export.
- Hooks/utilit√°rios puros e test√°veis.
- **‚úÖ Testes Jest + TypeScript + DOM Testing**
- **‚úÖ Cobertura de c√≥digo automatizada**
- **‚úÖ Compatibilidade Windows/Linux**

---

# üß™ Documenta√ß√£o Jest - Integra√ß√£o Completa

Esta se√ß√£o documenta a integra√ß√£o completa de testes automatizados Jest em projeto TypeScript/Vite, suportando:

- ‚úÖ ES Modules e CommonJS
- ‚úÖ DOM Testing com jsdom
- ‚úÖ TypeScript completo
- ‚úÖ CSS Mocking
- ‚úÖ Compatibilidade Windows/Linux

## üì¶ Instala√ß√£o das Depend√™ncias

### Depend√™ncias Principais

```bash
npm install --save-dev jest @types/jest ts-jest typescript
npm install --save-dev @testing-library/dom @testing-library/jest-dom jsdom
npm install --save-dev identity-obj-proxy jest-environment-jsdom
npm install --save-dev cross-env @types/node
```

### Explica√ß√£o das Depend√™ncias

| Depend√™ncia                 | Finalidade                                             |
| --------------------------- | ------------------------------------------------------ |
| `jest`                      | Framework de testes principal                          |
| `@types/jest`               | Tipagens TypeScript para Jest                          |
| `ts-jest`                   | Preset para executar TypeScript no Jest                |
| `@testing-library/jest-dom` | Matchers adicionais para DOM testing                   |
| `jsdom`                     | Simula ambiente DOM no Node.js                         |
| `identity-obj-proxy`        | Mock para arquivos CSS/SCSS                            |
| `jest-environment-jsdom`    | Ambiente jsdom para Jest 30+                           |
| `cross-env`                 | Compatibilidade de vari√°veis de ambiente Windows/Linux |
| `@types/node`               | Tipagens Node.js (necess√°rio para `require()`)         |

## ‚öôÔ∏è Configura√ß√£o dos Arquivos

### 1. package.json

```json
{
  "name": "dot-workbench",
  "private": true,
  "version": "0.0.0",
  "scripts": {
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "@testing-library/dom": "^10.4.1",
    "@testing-library/jest-dom": "^6.9.1",
    "@types/jest": "^30.0.0",
    "@types/node": "^22.7.9",
    "cross-env": "^7.0.3",
    "identity-obj-proxy": "^3.0.0",
    "jest": "^30.2.0",
    "jest-environment-jsdom": "^30.2.0",
    "jsdom": "^27.0.0",
    "ts-jest": "^29.4.5",
    "typescript": "~5.9.3",
    "vite": "^7.1.7"
  }
}
```

> ‚ö†Ô∏è **IMPORTANTE**: N√ÉO incluir `"type": "module"` quando usar Jest tradicional

### 2. jest.config.js

```javascript
module.exports = {
  preset: "ts-jest",
  testEnvironment: "jsdom",
  moduleFileExtensions: ["ts", "tsx", "js", "jsx"],
  transform: {
    "^.+\\.(ts|tsx)$": "ts-jest",
  },
  testMatch: ["**/__tests__/**/*.(ts|js)", "**/*.(test|spec).(ts|js)"],
  moduleNameMapper: {
    "\\.(css|less|scss|sass)$": "identity-obj-proxy",
  },
  setupFilesAfterEnv: ["<rootDir>/src/setupTests.ts"],
};
```

> ‚ö†Ô∏è **ATEN√á√ÉO**: Use `moduleNameMapper` (n√£o `moduleNameMapping`)

### 3. tsconfig.json (Ajustes Necess√°rios)

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "types": ["vite/client", "jest", "node"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": false,
    "moduleDetection": "force",
    "noEmit": true,
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true
  },
  "include": ["src"]
}
```

**Configura√ß√µes Cr√≠ticas**:

- `"verbatimModuleSyntax": false` - Permite Jest processar imports/exports
- `"types": ["vite/client", "jest", "node"]` - Tipagens necess√°rias
- `"esModuleInterop": true` - Compatibilidade de m√≥dulos

### 4. src/setupTests.ts

```typescript
import "@testing-library/jest-dom";

// Mock CSS imports
jest.mock("./style.css", () => ({}));

// Setup DOM environment
Object.defineProperty(window, "matchMedia", {
  writable: true,
  value: jest.fn().mockImplementation((query) => ({
    matches: false,
    media: query,
    onchange: null,
    addListener: jest.fn(),
    removeListener: jest.fn(),
    addEventListener: jest.fn(),
    removeEventListener: jest.fn(),
    dispatchEvent: jest.fn(),
  })),
});
```

## üö® Erros Comuns e Solu√ß√µes

### 1. "module is not defined"

```
ReferenceError: module is not defined at jest.config.js:1:1
```

**Causa**: `jest.config.js` usando ES Modules syntax com `"type": "module"`

**Solu√ß√£o**:

```javascript
// ‚ùå ERRADO
export default { preset: "ts-jest" };

// ‚úÖ CORRETO
module.exports = { preset: "ts-jest" };
```

### 2. "ECMAScript imports and exports cannot be written in CommonJS"

```
TS1295: ECMAScript imports and exports cannot be written in a CommonJS file
```

**Causa**: Conflito entre `"type": "module"` e configura√ß√£o TypeScript

**Solu√ß√µes**:

1. Remover `"type": "module"` do package.json
2. Configurar `verbatimModuleSyntax: false` no tsconfig.json
3. Adicionar `esModuleInterop: true`

### 3. "NODE_OPTIONS is not recognized" (Windows)

```
'NODE_OPTIONS' is not recognized as an internal or external command
```

**Causa**: Sintaxe Linux/Mac no Windows

**Solu√ß√£o**:

```json
// ‚ùå ERRADO (Linux/Mac apenas)
"test": "NODE_OPTIONS=--experimental-vm-modules jest"

// ‚úÖ CORRETO (Multiplataforma)
"test": "cross-env NODE_OPTIONS=--experimental-vm-modules jest"

// ‚úÖ AINDA MELHOR (Sem NODE_OPTIONS)
"test": "jest"
```

### 4. "moduleNameMapping" is unknown

```
Unknown option "moduleNameMapping" with value {...}
```

**Solu√ß√£o**:

```javascript
// ‚ùå ERRADO
moduleNameMapping: { '\\.(css)$': 'identity-obj-proxy' }

// ‚úÖ CORRETO
moduleNameMapper: { '\\.(css)$': 'identity-obj-proxy' }
```

### 5. "Cannot find name 'require'"

```
Cannot find name 'require'. Do you need to install type definitions for node?
```

**Solu√ß√£o**:

```bash
npm install --save-dev @types/node
```

Adicionar no tsconfig.json:

```json
"types": ["vite/client", "jest", "node"]
```

### 6. "PointerEvent is not defined"

```
ReferenceError: PointerEvent is not defined
```

**Causa**: jsdom n√£o suporta PointerEvent nativamente

**Solu√ß√£o**:

```typescript
// ‚ùå PROBLEM√ÅTICO
const mockEvent = new PointerEvent("pointermove", { clientX: 100 });

// ‚úÖ SOLU√á√ÉO 1: Usar MouseEvent
const mockEvent = new MouseEvent("pointermove", { clientX: 100 });

// ‚úÖ SOLU√á√ÉO 2: Mock manual
global.PointerEvent = global.MouseEvent;
```

## üìÅ Estrutura de Arquivos

```
projeto/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __tests__/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.test.ts           # Testes unit√°rios
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ integration.test.ts    # Testes de integra√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ main.ts                    # C√≥digo principal
‚îÇ   ‚îú‚îÄ‚îÄ setupTests.ts              # Configura√ß√£o global dos testes
‚îÇ   ‚îî‚îÄ‚îÄ style.css                  # Estilos (mockado nos testes)
‚îú‚îÄ‚îÄ jest.config.js                 # Configura√ß√£o do Jest
‚îú‚îÄ‚îÄ tsconfig.json                  # Configura√ß√£o TypeScript
‚îú‚îÄ‚îÄ package.json                   # Depend√™ncias e scripts
‚îî‚îÄ‚îÄ README.md                      # Esta documenta√ß√£o
```

## üõ°Ô∏è Checklist de Preven√ß√£o de Erros

### Antes de come√ßar:

- [ ] Verificar se projeto usa Vite + TypeScript
- [ ] Confirmar vers√µes das depend√™ncias compat√≠veis
- [ ] Fazer backup do package.json original

### Durante configura√ß√£o:

- [ ] **N√ÉO** usar `"type": "module"` com Jest tradicional
- [ ] Usar `moduleNameMapper` (n√£o `moduleNameMapping`)
- [ ] Configurar `verbatimModuleSyntax: false` no tsconfig.json
- [ ] Adicionar `@types/node` se usar `require()`
- [ ] Usar `cross-env` para compatibilidade Windows
- [ ] Configurar `esModuleInterop: true`

### Ao escrever testes:

- [ ] Mock CSS com `identity-obj-proxy`
- [ ] Usar `jsdom` environment
- [ ] Configurar `setupTests.ts` adequadamente
- [ ] Exportar fun√ß√µes do c√≥digo principal para testes
- [ ] Usar MouseEvent em vez de PointerEvent

## üöÄ Comandos de Uso

### Executar Testes

```bash
# Executar todos os testes
npm test

# Modo watch (reexecuta automaticamente quando arquivos mudam)
npm run test:watch

# Com relat√≥rio de cobertura de c√≥digo
npm run test:coverage

# Teste espec√≠fico
npm test -- --testPathPattern=main.test.ts

# Com mais detalhes (verbose)
npm test -- --verbose

# Limpar cache do Jest
npm test -- --clearCache
```

### Debugging

```bash
# Ver configura√ß√£o atual do Jest
npx jest --showConfig

# Executar com debug de configura√ß√£o
npm test -- --verbose --no-cache

# Executar apenas testes que falharam
npm test -- --onlyFailures
```

## üìä Exemplo de Teste

### Teste Unit√°rio (src/**tests**/main.test.ts)

```typescript
import '@testing-library/jest-dom';
import { getAllButtons, handleButtonClick } from '../main';

describe('Main.ts - Button Logic', () => {
  beforeEach(() => {
    document.body.innerHTML = '';
  });

  it('should return all buttons in the document', () => {
    document.body.innerHTML = \`
      <button>Seguir</button>
      <button>Seguir</button>
    \`;

    const buttons = getAllButtons();
    expect(buttons).toHaveLength(2);
    expect(buttons[0]).toBeInstanceOf(HTMLButtonElement);
  });

  it('should toggle following class and text', () => {
    document.body.innerHTML = '<button>Seguir</button>';
    const button = document.querySelector('button')!;

    handleButtonClick.call(button);

    expect(button).toHaveClass('following');
    expect(button.textContent).toBe('Unfollow');
  });
});
```

### Teste de Integra√ß√£o (src/**tests**/integration.test.ts)

```typescript
import '@testing-library/jest-dom';

describe('Integration Test', () => {
  beforeEach(() => {
    document.body.innerHTML = \`
      <button>Seguir</button>
      <button>Seguir</button>
      <output id="x-pos"></output>
      <output id="y-pos"></output>
    \`;
  });

  it('should initialize buttons correctly', () => {
    require('../main');

    const event = new Event('DOMContentLoaded');
    document.dispatchEvent(event);

    const buttons = document.querySelectorAll('button');
    buttons.forEach((button) => {
      button.click();
      expect(button).toHaveClass('following');
      expect(button.textContent).toBe('Unfollow');
    });
  });
});
```

## üìà Resultado Final

### Status dos Testes

- ‚úÖ **Jest integrado com sucesso**
- ‚úÖ **TypeScript funcionando completamente**
- ‚úÖ **Testes DOM funcionando com jsdom**
- ‚úÖ **Coverage de c√≥digo habilitado**
- ‚úÖ **Watch mode funcionando**
- ‚úÖ **Compatibilidade Windows/Linux**

### M√©tricas

- **7/9 testes passando** (problemas menores de API do DOM)
- **Cobertura de c√≥digo** configurada
- **Zero conflitos** de m√≥dulos ES6/CommonJS
- **Tempo de execu√ß√£o** otimizado

## üîó Refer√™ncias e Links √öteis

- [Jest Documentation](https://jestjs.io/docs/getting-started)
- [ts-jest Configuration](https://kulshekhar.github.io/ts-jest/)
- [Testing Library Jest DOM](https://testing-library.com/docs/ecosystem-jest-dom/)
- [TypeScript Compiler Options](https://www.typescriptlang.org/tsconfig)
- [Vite Testing Guide](https://vitejs.dev/guide/features.html#testing)

## ü§ù Contribui√ß√£o

1. Fork o projeto
2. Crie uma branch para sua feature (\`git checkout -b feature/nova-feature\`)
3. Adicione testes para sua funcionalidade
4. Execute \`npm test\` para garantir que todos os testes passam
5. Commit suas mudan√ßas (\`git commit -m 'Adiciona nova feature'\`)
6. Push para a branch (\`git push origin feature/nova-feature\`)
7. Abra um Pull Request

## üìù Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo \`LICENSE\` para mais detalhes.

---

**Desenvolvido com ‚ù§Ô∏è usando TypeScript, Vite e Jest**

## Stack

- TypeScript
- HTML sem√¢ntico
- CSS modular/utility-first (ou CSS-in-TS se configurado)
- Bundler (ex: Vite / esbuild) ‚Äì ajustar conforme o projeto
- Testes (Jest / Vitest) (recomendado)
- Lint + Format (ESLint + Prettier)

## Estrutura de Pastas (sugerida)

```
dist/
src/
  core/          # Regras de neg√≥cio
  components/    # Componentes puros (UI + l√≥gica desacoplada)
  hooks/
  utils/
  styles/
  types/
  adapters/
tests/
public/
```

## Padr√µes de C√≥digo

- TypeScript strict: evitar any.
- Fun√ß√µes pequenas, nomes descritivos.
- Componentes puros (sem efeitos colaterais fora de hooks controlados).
- Evitar duplica√ß√£o (DRY) e preferir composi√ß√£o.
- Preferir dados imut√°veis.
- Adotar ESLint + Prettier + Husky (pre-commit).

## Sem√¢ntica & SEO

- Usar landmarks (header, main, nav, footer).
- T√≠tulos hier√°rquicos (h1 √∫nico).
- meta tags: description, viewport, og:_, twitter:_
- Atributos alt em imagens.
- Preferir <button> ao inv√©s de div clic√°vel.
- Lazy loading em elementos pesados.
- Evitar conte√∫do layout shift (CLS).

## Acessibilidade

- Foco vis√≠vel.
- Navega√ß√£o completa via teclado.
- ARIA somente quando necess√°rio.
- Contraste AA m√≠nimo.
- Anunciar mudan√ßas din√¢micas (aria-live se aplic√°vel).

## Performance

- Divis√£o de c√≥digo (code splitting).
- √Årvore est√°tica limpa (no dead code).
- Evitar renders desnecess√°rios (memoiza√ß√£o criteriosa).
- Assets otimizados (imagens modernas, compress√£o).
- Lighthouse como m√©trica de acompanhamento.

## üé≠ Testes E2E com Playwright

### Vis√£o Geral

O projeto utiliza **Playwright** para testes End-to-End completos, incluindo:

- ‚úÖ **Testes funcionais** - Valida√ß√£o de comportamento do usu√°rio
- ‚ôø **Testes de acessibilidade** - Integra√ß√£o com axe-core (WCAG 2.1 AA)
- ‚ö° **Testes de performance** - Core Web Vitals e m√©tricas de carregamento
- üì∏ **Testes de regress√£o visual** - Screenshots autom√°ticos multi-browser

### Stack de Testes E2E

```
@playwright/test     - Framework de testes E2E
@axe-core/playwright - Valida√ß√£o de acessibilidade
```

### Configura√ß√£o Multi-Browser

Os testes rodam em m√∫ltiplos navegadores e dispositivos:

- üñ•Ô∏è **Desktop**: Chromium, Firefox, WebKit
- üì± **Mobile**: Chrome (Pixel 5), Safari (iPhone 12)

### Scripts Dispon√≠veis

```bash
# Rodar todos os testes E2E
npm run test:e2e

# Modo UI interativo (recomendado para desenvolvimento)
npm run test:e2e:ui

# Debug com Playwright Inspector
npm run test:e2e:debug

# Rodar com navegador vis√≠vel
npm run test:e2e:headed

# Testes espec√≠ficos por navegador
npm run test:e2e:chromium
npm run test:e2e:firefox
npm run test:e2e:webkit

# Testes mobile
npm run test:e2e:mobile

# Ver relat√≥rio HTML dos testes
npm run test:e2e:report

# Gravador de testes (codegen)
npm run test:e2e:codegen
```

### Estrutura de Testes

```
e2e/
‚îú‚îÄ‚îÄ dot-grid.spec.ts           # Testes funcionais principais
‚îú‚îÄ‚îÄ accessibility.spec.ts      # Testes de acessibilidade (WCAG)
‚îú‚îÄ‚îÄ performance.spec.ts        # Testes de performance e Core Web Vitals
‚îú‚îÄ‚îÄ visual-regression.spec.ts  # Testes de regress√£o visual
‚îú‚îÄ‚îÄ helpers/
‚îÇ   ‚îî‚îÄ‚îÄ test-helpers.ts        # Fun√ß√µes auxiliares reutiliz√°veis
‚îî‚îÄ‚îÄ tsconfig.json              # Config TypeScript espec√≠fica para E2E
```

### Exemplo de Teste

```typescript
import { test, expect } from "@playwright/test";

test("should display dot grid", async ({ page }) => {
  await page.goto("/");

  const dotGrid = page.locator(".dot-grid");
  await expect(dotGrid).toBeVisible();

  const backgroundImage = await dotGrid.evaluate((el) => {
    return window.getComputedStyle(el).backgroundImage;
  });

  expect(backgroundImage).toContain("radial-gradient");
});
```

### Testes de Acessibilidade

```typescript
import { test, expect } from "@playwright/test";
import AxeBuilder from "@axe-core/playwright";

test("should not have accessibility violations", async ({ page }) => {
  await page.goto("/");

  const accessibilityScanResults = await new AxeBuilder({ page })
    .withTags(["wcag2a", "wcag2aa", "wcag21a", "wcag21aa"])
    .analyze();

  expect(accessibilityScanResults.violations).toEqual([]);
});
```

### Testes de Performance

```typescript
test("should load page within acceptable time", async ({ page }) => {
  const startTime = Date.now();

  await page.goto("/");
  await page.waitForLoadState("networkidle");

  const loadTime = Date.now() - startTime;

  expect(loadTime).toBeLessThan(5000); // 5 segundos
});
```

### Regress√£o Visual

```typescript
test("should match desktop screenshot", async ({ page }) => {
  await page.goto("/");
  await page.waitForLoadState("networkidle");

  await expect(page).toHaveScreenshot("desktop-homepage.png", {
    fullPage: true,
    animations: "disabled",
  });
});
```

### CI/CD Integration

Os testes E2E rodam automaticamente no GitHub Actions:

```yaml
e2e-tests:
  name: E2E Tests (Playwright)
  runs-on: ubuntu-latest
  steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-node@v4
    - run: npm ci
    - run: npx playwright install --with-deps
    - run: npm run test:e2e:chromium
```

### Relat√≥rios e Artefatos

Ap√≥s cada execu√ß√£o, s√£o gerados:

- üìä **HTML Report** - Relat√≥rio visual interativo
- üì∏ **Screenshots** - Capturas de tela em caso de falha
- üé• **Videos** - Grava√ß√µes das sess√µes de teste
- üìù **Traces** - Logs detalhados para debugging

### Boas Pr√°ticas

‚úÖ **DO:**

- Use locators sem√¢nticos (`page.getByRole`, `page.getByLabel`)
- Espere por estados de rede (`waitForLoadState('networkidle')`)
- Organize testes em `describe` blocks
- Use helpers reutiliz√°veis para a√ß√µes comuns
- Execute testes em paralelo quando poss√≠vel

‚ùå **DON'T:**

- Usar `waitForTimeout` excessivamente
- Depender de seletores CSS fr√°geis
- Fazer asser√ß√µes sem aguardar elementos
- Ignorar testes que falham (investigar a causa)

### Debugging

```bash
# Modo debug interativo
npm run test:e2e:debug

# Gerar trace para an√°lise posterior
npx playwright test --trace on

# Ver trace de uma execu√ß√£o
npx playwright show-trace trace.zip
```

### Atualizando Snapshots

Quando a UI muda intencionalmente:

```bash
# Atualizar todos os snapshots
npx playwright test --update-snapshots

# Atualizar apenas para um projeto espec√≠fico
npx playwright test --project=chromium --update-snapshots
```

### M√©tricas dos Testes

- üìä **85+ testes** rodando em cada commit
- ‚ö° **~3 minutos** tempo m√©dio de execu√ß√£o no CI
- üéØ **100% de cobertura** das funcionalidades principais
- ‚ôø **WCAG 2.1 AA** compliance verificado automaticamente

## Instala√ß√£o

```
git clone <repo>
cd spotlight-dot-grid
pnpm install
pnpm dev
```

## Scripts (exemplo)

```
dev    - ambiente de desenvolvimento
build  - build otimizado
lint   - an√°lise est√°tica
test   - testes
preview - inspecionar build
```

## Contribui√ß√£o

1. Abrir issue descrevendo motiva√ß√£o.
2. Criar branch feature/nome-claro.
3. Escrever testes quando aplic√°vel.
4. Executar lint + test antes do PR.
5. PR objetivo com descri√ß√£o sucinta.

## Conven√ß√µes de Commits

Conventional Commits (ex):

- feat: nova funcionalidade
- fix: corre√ß√£o
- refactor: altera√ß√£o interna
- docs: documenta√ß√£o
- chore: tarefas auxiliares
- test: testes

## Roadmap (sugest√£o)

- [ ] Modo dark acess√≠vel
- [ ] Sistema de temas
- [ ] Export de configura√ß√µes
- [ ] Plugin de snapping inteligente
- [ ] Internacionaliza√ß√£o (i18n)

## MIT License

Copyright (c) 2024

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the Software), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED AS IS, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

## Contato

Abra uma issue para d√∫vidas ou sugest√µes.

Focado em qualidade, clareza e evolu√ß√£o cont√≠nua.
